import{a as e}from"./axios-CgL8z04V.js";import{L as r,M as o,K as t}from"./index-BeQWOJxL.js";const s=e.create({baseURL:t()});s.interceptors.request.use(e=>{const t=(()=>{try{const e=localStorage.getItem("userData");if(!e)return null;const t=JSON.parse(e),s=r.encryption.secretKey,n=o.AES.decrypt(t,s).toString(o.enc.Utf8);if(!n)return console.error("Decryption failed - empty result"),null;const a=JSON.parse(n);return a.auth_token||a.token}catch(e){return console.error("Error getting token from storage:",e),localStorage.removeItem("userData"),null}})();return t&&(e.headers=e.headers||{},e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var r,o,t,s,n,a,i;if(console.error("API Error:",{status:null==(r=e.response)?void 0:r.status,statusText:null==(o=e.response)?void 0:o.statusText,data:null==(t=e.response)?void 0:t.data,url:null==(s=e.config)?void 0:s.url,method:null==(n=e.config)?void 0:n.method}),e.response&&401===e.response.status){const r=(null==(i=null==(a=e.response)?void 0:a.data)?void 0:i.message)||"";(r.includes("expired")||r.includes("invalid"))&&(console.log("Token expired or invalid, redirecting to login"),window.location.href="/login")}return Promise.reject(e)});export{s as a};
